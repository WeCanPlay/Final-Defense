/*
* WeCanPlay : Library for html5 games
* http://www.wecanplay.fr/
* Version 1.0
*
* Copyright Â© WeCanPlay
* Permission is hereby granted, free of charge, to any person obtaining
* a copy of this software and associated documentation files (the
* "Software"), to deal in the Software without restriction, including
* without limitation the rights to use, copy, modify, merge, publish,
* distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to
* the following conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*/

(function(a,b,c){function d(){this.debug=!1,this.ctx=0,this.canvas=0,this.width=0,this.height=0}"use strict",d.prototype.setCanvas=function(a,c,d){this.canvas=b.getElementById(a),c>0&&d>0&&(this.canvas.width=c,this.canvas.height=d),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.ctx=this.canvas.getContext("2d"),this.initViewModule(),this.fire("canvasReady")},d.prototype.setMode=function(a){console.error("DEPRECATED - for log use WCP.log(true)")},d.prototype.log=function(a){typeof a=="boolean"&&(this.logEnable=a),this.logEnable&&console.log(a)},d.prototype.extend=function(a,b){console.error("DEPRECATED - see wiki template - kiss LeMulot")},window.WCP=new d})(window,document,undefined),function(a,b,c){function d(){}function e(){a.ctx.clearRect(0,0,a.width,a.height)}function f(a,b){var d=c.createElement("canvas");return d.width=a,d.height=b,d.ctx=d.getContext("2d"),d}function g(a,b){return Math.floor(Math.random()*(b-a+1))+a}"use strict",d.makeArray=function(a){return a instanceof Array||(a=[a]),a},d.inArray=function(a,b){for(var c=0;c<b.length;c++)if(b[c]===a)return!0;return!1},d.getCanvasPos=function(){var b=a.canvas,c=0,d=0;while(b.offsetParent)c+=b.offsetTop,d+=b.offsetLeft,b=b.offsetParent;return{top:c,left:d}},d.cloneObject=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},d.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},d.degresToRadian=function(a){return a*Math.PI/180},d._length=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},a.Tools=d,a.clear=e,a.bufferCanvas=f,a.random=g}(WCP,window,document),function(a){function b(a,b,c,d){arguments.length===1&&typeof a=="object"?(this.x=a.x,this.y=a.y):arguments.length===4?(this.x=c-a,this.y=d-b):(this.x=a,this.y=b)}"use strict",b.prototype.get=function(){return{x:this.x,y:this.y}},b.prototype.norm=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},b.prototype.normalize=function(){var a=this.norm();return new b(this.x/a,this.y/a)},b.prototype.add=function(a){return new b(this.x+a.x,this.y+a.y)},b.prototype.sub=function(a){return new b(this.x-a.y,this.y-a.y)},b.prototype.mult=function(a){return new b(this.x*a,this.y*a)},b.prototype.dot=function(a){return this.x*a.x+this.y*a.y},b.prototype.cross=function(a){return this.x*a.y+this.y*a.x},b.prototype.tangent=function(){return new b(-this.y,this.x)},b.prototype.angleTo=function(a){return Math.atan2(this.cross(a)/(this.norm()*a.norm()),this.dot(a))},b.prototype.absoluteAngle=function(){return Math.atan2(this.cross(new b(1,0)),this.dot(new b(1,0)))},b.norm=function(a,b){return Math.sqrt(a*a+b*b)},b.normalize=function(a,c){var d=b.norm(a,c);return{x:a/d,y:c/d}},b.add=function(a,b,c,d){return{x:a+c,y:b+d}},b.sub=function(a,b,c,d){return{x:a-c,y:b-d}},a.Vector=b}(WCP),function(a){function b(){return Date.now()/1e3}function c(){return Date.now()}function d(a){this.timeout=a||0,this.reset()}function e(){this.timer=new d,this.timeouts=[],this.nTimeouts=0,this.intervals=[],this.nIntervals=0,this.clear(),this.reset()}function f(a){this.precision=.1,this.duration=a||5,this.size=Math.ceil(this.duration/this.precision)+1,this.filled=0,this.index=0,this.previousTime=0,this.startTime=0,this.data=new Array(this.size),this.reset()}"use strict",a.internalTime=0,d.prototype.elapsedTime=function(){return this.pauseStart>0?this.pauseStart-this.startTime-this.pauseDuration:c()-this.startTime-this.pauseDuration},d.prototype.pause=function(){this.pauseStart===0&&(this.pauseStart=c())},d.prototype.unpause=function(){this.pauseStart>0&&(this.pauseDuration+=c()-this.pauseStart,this.pauseStart=0)},d.prototype.paused=function(){return this.pauseStart>0},d.prototype.expired=function(){return this.timeout?this.elapsedTime()>this.timeout:!1},d.prototype.reset=function(){this.startTime=c(),this.pauseStart=0,this.pauseDuration=0},e.prototype.update=function(){if(this.paused())return;var a=this.timer.elapsedTime(),b,c;for(b in this.timeouts){c=this.timeouts[b];if(c[0]<a)try{c[1]()}catch(d){throw d}finally{delete this.timeouts[b],this.nTimeouts--}}for(b in this.intervals){c=this.intervals[b];if(c[0]+c[1]<a){c[0]=a;try{c[2]()}catch(d){throw d}}}},e.prototype.clear=function(){this.timeouts=[],this.intervals=[],this.nTimeouts=0,this.nIntervals=0},e.prototype.setTimeout=function(a,b){return this.timeouts.push([this.timer.elapsedTime()+a,b]),this.nTimeouts++,this.timeouts.length-1},e.prototype.setInterval=function(a,b){return this.intervals.push([this.timer.elapsedTime(),a,b]),this.nIntervals++,this.intervals.length-1},e.prototype.clearTimeout=function(a){return this.timeouts[a]?(delete this.timeouts[a],this.nTimeouts--,!0):!1},e.prototype.clearInterval=function(a){return this.intervals[a]?(delete this.intervals[a],this.nIntervals--,!0):!1},e.prototype.reset=function(){this.timer.reset()},e.prototype.pause=function(){this.timer.pause()},e.prototype.unpause=function(){this.timer.unpause()},e.prototype.paused=function(){return this.timer.paused()},f.prototype.get=function(){var a=0,b=0;for(var c=0;c<this.size&&c<this.filled;c++)c!==this.index&&this.data[c]>0&&(a+=this.data[c],b++);return b===0?0:a/b/this.precision},f.prototype.tick=function(){var b=a.time(),c=b-this.startTime,d=Math.floor(c/this.precision)%this.size;this.index!==d&&(this.data[d]=0),this.data[d]++,this.index=d,d>this.filled&&(this.filled=d)},f.prototype.reset=function(){this.index=0,this.filled=0,this.startTime=0;for(var a=0;a<this.size;a++)this.data[a]=0},a.time=b,a.millitime=c,a.Timer=d,a.TimeScheduler=e,a.TimeCounter=f}(WCP),function(a){function b(a,b){this.callback=a,this.parse(b)}function c(){this.callbacks=[]}function d(a,b){b?typeof b=="Object"?this.event=b:this.event=new c:this.event=new c,this.type=a}function e(){this.combos={},this.keys={},this.sequenceEntry=[],this.matchingSequences={},this.sequenceToCall=0,this._default={interval_timeout:500,ordered:!0}}function f(){}function g(a,b,c,d){var e,f;return e=Math.abs(a-c),f=Math.abs(b-d),e>=f?a-c>0?"Left":"Right":b-d>0?"Up":"Down"}function h(a,b,c){var d=g(a.clientX,a.clientY,b.clientX,b.clientY),e=Math.abs(a.clientX-b.clientX)>30,f=Math.abs(a.clientY-b.clientY)>30;e&&(d==="Left"||d==="Right")&&c.fire("swipe",d),f&&(d==="Up"||d==="Down")&&c.fire("swipe",d)}function i(a,b){for(var c in b)typeof a[b[c]]!="undefined"&&(document.getElementById("displayCE").innerHTML+=a[b[c]]+" ")}"use strict",b.prototype.parse=function(a){if(typeof a=="string"&&a!=="undefined"){var b=a.split("|");this.keys={};for(var c in b)this.keys[c]=b[c]}},c.keyCodes={8:"back_tab",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"escape",32:"space",37:"left",38:"up",39:"right",40:"down",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z"},c.keyCode=function(a){for(var b in c.keyCodes)if(c.keyCodes[b]===a)return b;return-1},d.prototype.rename=function(a){this.type=a},d.prototype.subscribe=function(a){this.event.callbacks.push(new b(a))},d.prototype.on=function(a){this.subscribe(a)},d.prototype.unsubscribe=function(a){var b=!1;for(var c in this.event.callbacks)this.event.callbacks[c].callback&&(this.event.callbacks[c].callback===a||!a)&&(delete this.event.callbacks[c],b=!0);return b},d.prototype.fire=function(a){if(a)for(var b in this.event.callbacks)this.event.callbacks[b].callback&&this.event.callbacks[b].callback(a);else for(var b in this.event.callbacks)this.event.callbacks[b].callback&&this.event.callbacks[b].callback()},e.prototype.addSequence=function(a,b){typeof b=="object"&&(b.sequence=!0),this.add(a,b)},e.prototype.add=function(b,c){if(this.combos[b])for(var d in c)this.combos[b][d]=c[d];else this.combos[b]={},this.combos[b]=a.Tools.cloneObject(this._default),a.Tools.extend(this.combos[b],c),this.combos[b].total_timeout||(this.combos[b].total_timeout=this.combos[b].interval_timeout*b.split(" ").length)},e.prototype.addKey=function(b,c){if(this.keys[b])for(var d in c)this.keys[b][d]=c[d];else this.keys[b]={},this.keys[b]=a.Tools.cloneObject(this._default),a.Tools.extend(this.keys[b],c)},e.prototype.getCombos=function(){var a={};for(var b in this.combos)this.combos[b].sequence===!1&&(a[b]=this.combos[b]);return a},e.prototype.getSequences=function(){var a={};for(var b in this.combos)this.combos[b].sequence===!0&&(a[b]=this.combos[b]);return a},e.prototype.getSequencesCopy=function(){var b={};for(var c in this.combos)this.combos[c].sequence===!0&&(b[c]=a.Tools.cloneObject(this.combos[c]));return b},e.prototype.arrayCmp=function(a,b){if(a.length!==b.length)return!1;for(var c in a){var d=!1;for(var e in b)if(b[e]===a[c]){d=!0;break}if(!d)return!1}return!0},e.prototype.arrayCmpOrdered=function(a,b){if(a.length!==b.length)return!1;for(var c in a)if(a[c]!==b[c])return!1;return!0},e.prototype.update=function(b){clearTimeout(),this.sequenceToCall=0,a.Tools._length(this.matchingSequences)===0&&this.sequenceEntry.length===0&&(this.matchingSequences=this.getSequencesCopy(),this.sequenceEntry.length=0),this.sequenceEntry.push(b);var c=0;for(var d in this.matchingSequences){var e=d.split(" ");if(e[this.sequenceEntry.length-1]===this.sequenceEntry[this.sequenceEntry.length-1].key){if(this.sequenceEntry.length>=2&&this.sequenceEntry[this.sequenceEntry.length-1].age-this.sequenceEntry[this.sequenceEntry.length-2].age>this.matchingSequences[d].interval_timeout){delete this.matchingSequences[d];continue}this.matchingSequences[d].interval_timeout>c&&(c=this.matchingSequences[d].interval_timeout),e.length===this.sequenceEntry.length&&this.matchingSequences[d].keydown&&(this.sequenceToCall=this.matchingSequences[d].keydown,delete this.matchingSequences[d])}else delete this.matchingSequences[d]}if(a.Tools._length(this.matchingSequences)===0)this.sequenceToCall&&(this.sequenceToCall(),this.sequenceToCall=0),this.sequenceEntry.length>1?(this.sequenceEntry.length=0,this.update(b)):this.sequenceEntry.length=0;else{var f=this;setTimeout(function(a){return function(){a.sequenceToCall&&(a.sequenceToCall(),a.sequenceToCall=0),a.sequenceEntry.length=0,a.matchingSequences={}}}(this),c)}},e.prototype.getMatchingCombos=function(a,b){var c={};for(var d in a){if(typeof a[d]!="object")continue;var e=d.split(" ");a[d].ordered?this.arrayCmpOrdered(e,b)&&(c[d]=a[d]):this.arrayCmp(e,b)&&(c[d]=a[d])}return c},e.prototype.find=function(a,b){if(a.type==="combo"){var c=this.getCombos();a.keys||b(c),b(this.getMatchingCombos(c,a.keys))}if(a.type==="sequence"){var d=this.getSequences();b(d)}},e.prototype.triggerKeydown=function(a,b){this.keys[a]&&this.keys[a].keydown&&this.keys[a].keydown(b)},e.prototype.triggerKeyup=function(a,b){this.keys[a]&&this.keys[a].keyup&&this.keys[a].keyup(b)},f.extend=function(a){a.prototype.initEvents=f.prototype.initEvents,a.prototype.initCurrentEvent=f.prototype.initCurrentEvent,a.prototype.initMobileEvent=f.prototype.initMobileEvent,a.prototype.currentEvent=f.prototype.currentEvent,a.prototype.listen=f.prototype.listen,a.prototype.handleEvents=f.prototype.handleEvents,a.prototype.custom=f.prototype.custom,a.prototype.getEvent=f.prototype.getEvent,a.prototype.register=f.prototype.register,a.prototype.addDrawableController=f.prototype.addDrawableController,a.prototype.subscribe=f.prototype.subscribe,a.prototype.unsubscribe=f.prototype.unsubscribe,a.prototype.on=f.prototype.on,a.prototype.off=f.prototype.off,a.prototype.fire=f.prototype.fire,a.prototype.parseEvent=f.prototype.parseEvent,a.prototype.combo=f.prototype.combo,a.prototype.advancedCombo=f.prototype.advancedCombo,a.prototype.sequence=f.prototype.sequence,a.prototype.advancedSequence=f.prototype.advancedSequence,a.prototype.keydown=f.prototype.keydown,a.prototype.keyup=f.prototype.keyup;var b=new a;return b.listen(),b},f.extendObject=function(b){b.initEvents=f.prototype.initEvents,b.initCurrentEvent=f.prototype.initCurrentEvent,b.initMobileEvent=f.prototype.initMobileEvent,b.currentEvent=f.prototype.currentEvent,b.listen=f.prototype.listen,b.handleEvents=f.prototype.handleEvents,b.custom=f.prototype.custom,b.getEvent=f.prototype.getEvent,b.register=f.prototype.register,b.addDrawableController=f.prototype.addDrawableController,b.subscribe=f.prototype.subscribe,b.unsubscribe=f.prototype.unsubscribe,b.on=f.prototype.on,b.off=f.prototype.off,b.fire=f.prototype.fire,b.parseEvent=f.prototype.parseEvent,b.combo=f.prototype.combo,b.advancedCombo=f.prototype.advancedCombo,b.sequence=f.prototype.sequence,b.advancedSequence=f.prototype.advancedSequence,b.keydown=f.prototype.keydown,b.keyup=f.prototype.keyup,b.initEvents(),a.canvas?b.listen():(b.custom("canvasReady"),b.on("canvasReady",function(a){return function(){a.listen()}}(b)))},f.prototype.initEvents=function(){this.events||(this.events={}),this.events._events||(this.events._events=[])},f.prototype.initMobileEvent=function(){this.on("mousedown",function(a){return function(b){a.events._lastEvent=b}}(this)),this.on("mouseup",function(a){return function(b){h(a.events._lastEvent,b,a)}}(this))},f.prototype.initCurrentEvent=function(a){this.events||(this.events={}),this.events.currentEvent=a},f.prototype.listen=function(b){this.events={},this.initEvents(),this.events._keysdown=[],this.events._drawables=[],this.events._time=new Date,this.events._time.setTime(this.events._time.getTime()),this.events._timeScheduler=new a.TimeScheduler,this.events._combos=new e;var c=b?b:a.canvas;if(!c)return;var f={mouseover:!0,mouseout:!0,mousemove:!0,mousedown:!0,mouseup:!0,click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,touchstart:!0,touchmove:!0,touchend:!0,touchcancel:!0,drag:!0,dragstart:!0,dragmove:!0,dragend:!0,gesturestart:!0,gestureend:!0,gesturechange:!0,scrollstart:!0,scrollstop:!0,rotate:!0,rotatecw:!0,rotateccw:!0,pinch:!0,pinchopen:!0,pinchclose:!0,orientationchange:!0,tap:!0,taphold:!0,tapone:!0,taptwo:!0,tapthree:!0,dbltap:!0,swipe:!0,swipemove:!0,swipeone:!0,swipetwo:!0,swipethree:!0,swipefour:!0,swipeup:!0,swiperightup:!0,swiperight:!0,swiperightdown:!0,swipedown:!0,swipeleftdown:!0,swipeleft:!0,swipeleftup:!0};for(var g in f)this.events._events.push(new d(g)),c.addEventListener(g,function(a){return function(b){a.handleEvents(b)}}(this),!1);window.addEventListener("keydown",function(a){return function(b){a.handleEvents(b)}}(this)),window.addEventListener("keyup",function(a){return function(b){a.handleEvents(b)}}(this))},f.prototype.handleEvents=function(b){typeof this.events.currentEvent!="undefined"&&this.currentEvent(b);if(b.type==="keydown")this.events._combos.triggerKeydown(c.keyCodes[b.keyCode],b),this.events._combos.update({key:c.keyCodes[b.keyCode],age:a.millitime()%1e4}),this.events._keysdown.indexOf(c.keyCodes[b.keyCode])===-1&&(this.events._keysdown.push(c.keyCodes[b.keyCode]),this.events._combos.find({keys:this.events._keysdown,type:"combo"},function(a){for(var c in a)a[c].keydown&&a[c].keydown(b)}));else if(b.type==="keyup")this.events._combos.triggerKeyup(c.keyCodes[b.keyCode],b),this.events._combos.find({keys:this.events._keysdown,type:"combo"},function(a){for(var c in a)a[c].keyup&&a[c].keyup(b)}),this.events._keysdown.indexOf(c.keyCodes[b.keyCode])!==-1&&this.events._keysdown.splice(this.events._keysdown.indexOf(c.keyCodes[b.keyCode]),1);else if(b.type==="mousedown"){this.fire(b.type,b);for(var d in this.events._drawables){var e=this.events._drawables[d];e.isPointInPath(b.clientX,b.clientY)&&e._callbacks.mousedown&&e._callbacks.mousedown(b)}}else this.fire(b.type,b)},f.prototype.keydown=function(a,b){var c={keydown:b,sequence:!1};this.events._combos.addKey(a,c)},f.prototype.keyup=function(a,b){var c={keyup:b,sequence:!1};this.events._combos.addKey(a,c)},f.prototype.combo=function(a,b){var c={keydown:b,sequence:!1,ordered:!0};this.events._combos.add(a,c)},f.prototype.sequence=function(a,b){var c={keydown:b,sequence:!0};this.events._combos.add(a,c)},f.prototype.advancedCombo=function(a){for(var b in a)this.events._combos.add(b,a[b])},f.prototype.advancedSequence=function(a){for(var b in a)this.events._combos.addSequence(b,a[b])},f.prototype.getEvent=function(a){if(typeof a=="object")return a;for(var b in this.events._events)if(this.events._events[b].type===a)return this.events._events[b]},f.prototype.register=function(a){a.prototype.subscribe=function(a){return function(b,c){a.on(b,c)}}(this),a.prototype.on=function(a,b){this.subscribe(a,b)},a.prototype.unsubscribe=function(a){return function(b,c){a.unsubscribe(b,c)}}(this),a.prototype.off=function(a,b){this.unsubscribe(a,b)},a.prototype.custom=function(a){return function(b){a.custom(b)}}(this),a.prototype.keydown=function(a){return function(b,c){a.keydown(b,c)}}(this),a.prototype.keyup=function(a){return function(b,c){a.keyup(b,c)}}(this),a.prototype.sequence=function(a){return function(b,c){a.sequence(b,c)}}(this),a.prototype.combo=function(a){return function(b,c){a.combo(b,c)}}(this),a.prototype.advancedSequence=function(a){return function(b){a.advancedSequences(b)}}(this),a.prototype.advancedCombo=function(a){return function(b){a.advancedCombo(b)}}(this),a.prototype.fire=function(a){return function(b,c){a.fire(b,c)}}(this)},f.prototype.addDrawableController=function(a){if(!a.isPointInPath)throw new Error("You must implement the method isPointInPath in the object to register");return a._drawableId=this.events._drawables.length,a._callbacks={mousemove:0,mouseover:0,mousedown:0,mouseup:0,click:0},a.on=function(a){return function(a,b){this.evtName(b)}}(this),a.mousedown=function(a){return function(a){this._callbacks.mousedown=a}}(this),a.mousemove=function(a){return function(a){this._callbacks.mousemove=a}}(this),a.mouseover=function(a){return function(a){this._callbacks.mouseover=a}}(this),a.mouseup=function(a){return function(a,b){this._callbacks.mouseup=b}}(this),a.click=function(a){return function(a){this._callbacks.mousedown=a}}(this),this.events._drawables.push(a),this.events._drawables.length-1},f.prototype.custom=function(a,b){var c=this.getEvent(a);if(c&&b===!0)this.unsubscribe(a);else if(c&&!b)return;return c=new d(a),this.events._events.push(c),c},f.prototype.on=function(a,b){this.subscribe(a,b)},f.prototype.subscribe=function(a,b){if(typeof a=="string")this.parseEvent(a,b);else if(typeof a=="object")for(var c in a)this.parseEvent(c,a[c])},f.prototype.parseEvent=function(a,b){var c=[],d={};c=a.split(" "),d=this.getEvent(c[0]!==undefined?c[0]:a),d&&d.subscribe(b,c.length===2?c[1]:0)},f.prototype.unsubscribe=function(a,b){var c=this.getEvent(a);if(!a)for(var d in this.events._events)this.events._events[d].unsubscribe();else c&&c.unsubscribe(b)},f.prototype.off=function(a,b){this.unsubscribe(a,b)},f.prototype.currentEvent=function(b){var c=a.canvas.getBoundingClientRect(),d=document.documentElement,e=b.clientX-c.top-d.scrollTop,f=b.clientY-c.left-d.scrollLeft,g="";typeof b.clientX!="undefined"&&typeof (b.clientY!=="undefined")&&(g+=" - PosX = "+e+" - PosY = "+f),typeof b.keyCode!="undefined"&&b.keyCode!==0&&(g+=" - Key = "+b.keyCode),typeof b.buttons!="undefined"&&b.buttons!==0&&(g+=" - Button = "+b.buttons),typeof this.events.currentEvent=="object"?i(b,this.events.currentEvent):this.events.currentEvent===!1?(document.getElementById("displayCE").innerHTML+=b.type+g,console.log(b.type+g)):(typeof b.screenX!="undefined"&&typeof (b.screenY!=="undefined")&&(g+=" - ScreenX = "+b.screenX+" - ScreenY = "+b.screenY),typeof b.target!="undefined"&&(g+=" - Target = "+b.target.localName),document.getElementById("displayCE").innerHTML+=b.type+g,console.log(b)),document.getElementById("displayCE").innerHTML+="<br />",document.getElementById("displayCE").scrollTop=1e4},f.prototype.fire=function(a,b){var c=this.getEvent(a);c&&c.fire(b)},a.EventTarget=f,a.Event=c,f.extendObject(a),a.initEvents(),a.custom("canvasReady");var j=40,k=38,l=37,m=39,n=35,o=36,p=8,q=9,r=16,s=13,t=27,u=32,v=46,w=65,x=66,y=67,z=68,A=69,B=70,C=71,D=72,E=73,F=74,G=75,H=76,I=77,J=78,K=79,L=80,M=81,N=82,O=83,P=84,Q=85,R=86,S=87,T=88,U=89,V=90,W=112,X=113,Y=114,Z=115,$=116,_=117,ba=118,bb=119,bc=48,bd=49,be=50,bf=51,bg=52,bh=53,bi=54,bj=55,bk=56,bl=57}(WCP),function(a){function c(){this._zindex=100,this._parent=null}function d(){this._children=[]}function e(b){this.refresh=b.refreshRate||1e3/60,this.lastUpdate=0,this.active=!1,this.paused=!1,this.sched=new a.TimeScheduler,this.fn={init:b.init||function(){},loop:b.loop||function(){},draw:b.draw||function(){},destroy:b.destroy||function(){}}}function f(){while(b.activeViews.length>0)b.activeViews[0].stop()}function g(b){b=b<1?1:b>60?60:b,a.globalFps=b}function h(){return a.globalFps}function i(){return a.fpsCounter.get()}function j(a,c){return c?function(){b.updatingView&&b.updatingView[c][a].apply(b.updatingView[c],arguments)}:function(){b.updatingView&&b.updatingView[a].apply(b.updatingView,arguments)}}function k(){window.requestAnimFrame(k);var c=a.millitime();if(c-b.lastGlobalUpdateTime<1e3/a.globalFps)return;b.lastGlobalUpdateTime=c;var d=!1;for(var e=0,f=b.activeViews.length;e<f;e++){var g=b.activeViews[e];g.lastUpdate===0&&(g.lastUpdate=b.lastGlobalUpdateTime),d||(a.clear(),a.fpsCounter.tick(),d=!0),g.active===!0?g.update():g.paused&&g.draw(),g.lastUpdate=b.lastGlobalUpdateTime}}"use strict",window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1e3/60)}}();var b={activeViews:[],updatingView:null,lastGlobalUpdateTime:0};a.globalFps=60,a.fpsCounter=new a.TimeCounter,c.prototype.draw=function(a){throw new Error("You have to override the draw(ctx) method")},c.prototype.setZIndex=function(a){a>999&&(a=999),a<0&&(a=0);var b=this._zindex;this._zindex=a,this._parent&&this._parent._notifyZIndexChange(this,b,a)},c.prototype.getZIndex=function(){return this._zindex},d.prototype=new c,d.prototype.draw=function(b){b=b||a.ctx;for(var c in this._children)if(this._children.hasOwnProperty(c)){var d=this._children[c];for(var e=0,f=d.length;e<f;e++)d[e].draw(b)}},d.prototype._notifyZIndexChange=function(a,b,c){if(a._parent!==this)return;this._children[c]||(this._children[c]=[]);var d=this._children[b].indexOf(a);this._children[b].splice(d,1),this._children[c].push(a)},d.prototype.add=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a],c=b._zindex;b._parent!==this&&(this._children[c]||(this._children[c]=[]),this._children[c].push(b),b._parent&&b._parent.remove(b),b._parent=this)}},d.prototype.remove=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a],c=b._zindex;if(b._parent===this&&this._children[c]){var d=this._children[c].indexOf(b);this._children[c].splice(d,1),b._parent=null}}},d.prototype.removeAll=function(){for(var a in this._children)if(this._children.hasOwnProperty(a)){var b=this._children[a];for(var c=0,d=b.length;c<d;c++)b[c]._parent=null}this._children=[]},d.prototype.getChildren=function(){return this._children},e.prototype=new d,e.prototype.update=function(){this.active&&(b.updatingView=this,this.sched.update(),this.fn.loop.call(this),this.draw(),b.updatingView=null)},e.prototype.draw=function(a){d.prototype.draw.call(this,a),this.fn.draw.call(this)},e.prototype.start=function(a){this.active||(this.active=!0,b.activeViews.push(this),b.updatingView=this,this.fn.init.call(this,a),b.updatingView=null)},e.prototype.stop=function(){this.active&&(b.updatingView=this,this.fn.destroy.call(this),b.updatingView=null,this.active=!1,this.paused=!1,this.lastUpdate=0,b.activeViews.splice(b.activeViews.indexOf(this),1),this.removeAll(),this.sched.reset())},e.prototype.pause=function(){!this.paused&&this.active&&(this.paused=!0,this.active=!1,this.sched.pause())},e.prototype.unpause=function(){this.paused&&(this.paused=!1,this.active=!0,this.sched.unpause())},e.prototype.elapsed=function(){return b.lastGlobalUpdateTime-this.lastUpdate},a.Drawable=c,a.Layer=d,a.View=e,a.clearViews=f,a.setFps=g,a.getFps=h,a.getRealFps=i,a.add=j("add"),a.remove=j("remove"),a.setTimeout=j("setTimeout","sched"),a.clearTimeout=j("clearTimeout","sched"),a.setInterval=j("setInterval","sched"),a.clearInterval=j("clearInterval","sched"),a.initViewModule=function(){a.fpsCounter.reset(),k()}}(WCP),function(a){function e(d,e,f){this.img=d,this.x=e||0,this.y=f||0,this.width=d.width,this.height=d.height,this.sliceX=0,this.sliceY=0,this.sliceWidth=this.width,this.sliceHeight=this.height,this.alpha=1,this.id=b++,this.originX=0,this.originY=0,this.originType=c,this.rotation=0,this.scaleX=1,this.scaleY=1,this.matrix=[1,0,0,1,0,0],this.symmetryX=this.symmetryY=!1,this.animationsData=[],this.animation=new a.Animation(this),this.mainAnimation=null}function f(a,b,c,d,f){var g=new e(a,0,0);return g.setSlice(b,c,d,f),g}"use strict";var b=1,c=0,d=1;e.prototype=new a.Drawable,e.prototype.clone=function(b,c){var d=new a.Sprite(this.img,b,c);for(var e in this)this.hasOwnProperty(e)&&e!=="id"&&this.hasOwnProperty(e)&&e!=="x"&&this.hasOwnProperty(e)&&e!=="y"&&(d[e]=this[e]);return d},e.prototype.setSubRect=function(a){this.sliceX=a.x,this.sliceY=a.y,this.sliceWidth=a.width,this.sliceHeight=a.height},e.prototype.setSlice=function(a,b,c,d){this.width=c,this.height=d,this.sliceX=a,this.sliceY=b,this.sliceWidth=c,this.sliceHeight=d},e.prototype.draw=function(b){b=b||a.ctx,b.save(),b.globalAlpha=this.alpha;var d,e,f=this.width,g=this.height;this.originType===c?(d=this.originX,e=this.originY):(d=f*this.originX,e=g*this.originY);var h=this.symmetryX===!0?-1:1,i=this.symmetryY===!0?-1:1;h===-1&&(d+=this.width),i===-1&&(e+=this.height),b.translate(this.x,this.y),b.rotate(this.rotation),b.scale(h,i),b.drawImage(this.img,this.sliceX,this.sliceY,this.sliceWidth,this.sliceHeight,-d,-e,f,g),b.restore()},e.prototype.move=function(a,b){this.x+=a,this.y+=b},e.prototype.position=function(a,b){this.x=a,this.y=b},e.prototype.scale=function(a,b){typeof b=="undefined"&&(b=a),this.scaleX=a,this.scaleY=b,this.width=this.sliceWidth*this.scaleX,this.height=this.sliceHeight*this.scaleY},e.prototype.symmetry=function(a,b){this.symmetryX=a,this.symmetryY=b},e.prototype.vector=function(){return new a.Vector(this.x,this.y)},e.prototype.getPos=function(){return{x:this.x,y:this.y}},e.prototype.getRect=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.animations=function(a){this.animationsData=a},e.prototype.addAnimation=function(a){for(var b in this.animationsData[a]){var c=this.animationsData[a][b];this.animation.setSlice(c.x,c.y,c.width,c.height),typeof this.animationsData.frameRate!="undefined"?this.animation.wait(this.animationsData.frameRate):typeof this.animationsData.timeRate!="undefined"&&this.animation.waitTime(this.animationsData.timeRate)}},e.prototype.setAnimation=function(a,b,c){if(typeof this.animationsData[a]=="undefined")return;this.animation.clean(),this.addAnimation(a),typeof b=="number"?(this.animation.repeat(b-1),this.animation.clear(),typeof c=="function"&&(this.animation.execute(c),this.animation.clear()),this.mainAnimation!==null&&(this.addAnimation(this.mainAnimation),this.animation.repeat())):(this.animation.repeat(),this.mainAnimation=a),this.animation.start()},e.prototype.setOrigin=function(a,b){!b&&typeof a[0]!="undefined"?(this.originX=a[0],this.originY=a[1]):(this.originX=a,this.originY=b),this.originType=d},e.prototype.setOriginPos=function(a,b){this.originX=a,this.originY=b,this.originType=c},e.ORIGIN_TOPLEFT=[0,0],e.ORIGIN_TOP=[.5,0],e.ORIGIN_TOPRIGHT=[1,0],e.ORIGIN_LEFT=[0,.5],e.ORIGIN_CENTER=[.5,.5],e.ORIGIN_RIGHT=[1,.5],e.ORIGIN_BOTLEFT=[0,1],e.ORIGIN_BOT=[.5,1],e.ORIGIN_BOTRIGHT=[1,1],a.Sprite=e,a.SliceSprite=f}(WCP),function(a){function b(){}function c(){this.styles={},this.options={strokeStyle:"Black",fillStyle:"White",lineWidth:1},this.ctx=a.ctx;var b=function(b){return function(){b.ctx=a.ctx}}(this);a.on("canvasReady",b)}"use strict",b.prototype=new a.Drawable,b.prototype.buildPath=function(a){throw new Error("You have to override the buildPath(ctx) method")},b.prototype.draw=function(b){b||(b=a.Draw.ctx),b.save(),b.beginPath(),this.buildPath(b);for(var c in this.style)b[c.toString()]=this.style[c];b.fill(),b.stroke(),b.closePath(),b.restore()},b.prototype.isPointInPath=function(b,c,d){d||(d=a.Draw.ctx),d.save(),d.beginPath(),this.buildPath(d);for(var e in this.style)d[e.toString()]=this.style[e];d.fill(),d.stroke();var f=d.isPointInPath(b,c);return d.closePath(),d.restore(),f},c.prototype.setContext=function(a){this.ctx=a},c.prototype.draw=function(a,b){a||(a=this.ctx);for(var c in b)a[c.toString()]=b[c];a.fill(),a.stroke()},c.prototype.defaultStyle=function(a){for(var b in this.options)a[b]===undefined&&(a[b]=this.options[b]);this.options=a},c.prototype.newStyle=function(){return{}},c.prototype.addStyle=function(a,b){b!==undefined&&(this.styles[b]=a)},c.prototype.removeStyle=function(a){return this.styles[a]?(this.styles[a]=0,!0):!1},c.prototype.newPolygon=function(){return{array:[],length:0,add:function(a,b){var c={x:a,y:b};this.array[this.length++]=c}}},c.prototype.point=function(a,b,c,d){return new this.Point(a,b,c,d)},c.prototype.Point=function(a,b,c,d){this.x=a,this.y=b,this.size=c,this.color=d},c.prototype.Point.prototype=new b,c.prototype.Point.prototype.buildPath=function(){this.size||(this.size=1),this.color&&(a.Draw.ctx.fillStyle=this.color),a.Draw.ctx.fillRect(this.x-(this.size/2>=1?this.size/2:0),this.y-(this.size/2>=1?this.size/2:0),this.size,this.size)},c.prototype.line=function(a,b,c,d,e){return new this.Line(a,b,c,d,e)},c.prototype.Line=function(a,b,c,d,e){this.x1=a,this.y1=b,this.x2=c,this.y2=d,this.style=e},c.prototype.Line.prototype=new b,c.prototype.Line.prototype.buildPath=function(a){a.moveTo(this.x1,this.y1),a.lineTo(this.x2,this.y2)},c.prototype.circle=function(a,b,c,d){return new this.Circle(a,b,c,d)},c.prototype.Circle=function(a,b,c,d){this.x=a,this.y=b,this.radius=c,this.style=d},c.prototype.Circle.prototype=new b,c.prototype.Circle.prototype.buildPath=function(a){a.arc(this.x,this.y,this.radius,0,2*Math.PI,!1)},c.prototype.ellipse=function(a,b,c,d,e){return new this.Ellipse(a,b,c,d,e)},c.prototype.Ellipse=function(a,b,c,d,e){this.x=a,this.y=b,this.width=c,this.height=d,this.style=e},c.prototype.Ellipse.prototype=new b,c.prototype.Ellipse.prototype.buildPath=function(a){a.moveTo(this.x,this.y-this.height/2),a.bezierCurveTo(this.x+this.width/2,this.y-this.height/2,this.x+this.width/2,this.y+this.height/2,this.x,this.y+this.height/2),a.bezierCurveTo(this.x-this.width/2,this.y+this.height/2,this.x-this.width/2,this.y-this.height/2,this.x,this.y-this.height/2)},c.prototype.rect=function(a,b,c,d,e){return new this.Rect(a,b,c,d,e)},c.prototype.Rect=function(a,b,c,d,e){this.x=a,this.y=b,this.width=c,this.height=d,this.style=e},c.prototype.Rect.prototype=new b,c.prototype.Rect.prototype.buildPath=function(a){a.moveTo(this.x,this.y),a.lineTo(this.x+this.width,this.y),a.lineTo(this.x+this.width,this.y+this.height),a.lineTo(this.x,this.y+this.height),a.lineTo(this.x,this.y)},c.prototype.polygon=function(a,b){return new this.Polygon(a,b)},c.prototype.Polygon=function(a,b){a.array!==undefined?a.array instanceof Array&&(this.points=a.array):this.points=a,this.style=b},c.prototype.Polygon.prototype=new b,c.prototype.Polygon.prototype.buildPath=function(a){if(this.points instanceof Array){var b=this.points;b.reverse();var c=b.pop();a.moveTo(c.x,c.y);while(b.length>0){var d=b.pop();d&&a.lineTo(d.x,d.y)}a.lineTo(c.x,c.y)}},c.prototype.quadraCurve=function(a,b,c,d,e,f,g){return new this.QuadraCurve(a,b,c,d,e,f,g)},c.prototype.QuadraCurve=function(a,b,c,d,e,f,g){this.x1=a,this.y1=b,this.cpx=c,this.cpy=d,this.x2=e,this.y2=f,this.style=g},c.prototype.QuadraCurve.prototype=new b,c.prototype.QuadraCurve.prototype.buildPath=function(a){a.moveTo(this.x1,this.y1),a.quadraticCurveTo(this.cpx,this.cpy,this.x2,this.y2)},c.prototype.bezierCurve=function(a,b,c,d,e,f,g,h,i){return new this.BezierCurve(a,b,c,d,e,f,g,h,i)},c.prototype.BezierCurve=function(a,b,c,d,e,f,g,h,i){this.x1=a,this.y1=b,this.cpx1=c,this.cpy1=d,this.cpx2=e,this.cp2y=f,this.x2=g,this.y2=h,this.style=i},c.prototype.BezierCurve.prototype=new b,c.prototype.BezierCurve.prototype.buildPath=function(a){a.moveTo(this.x1,this.y1),a.bezierCurveTo(this.cpx1,this.cpy1,this.cpx2,this.cpy2,this.x2,this.y2)},a.Draw=new c}(WCP),function(a){function d(){b[c]=this,this.animateId=c,c++,this.timeLine=[],this.time=0,this.startTime=-1}function e(){this.clip=this,this.list=[],this.index=0}function f(a,d){b[c]=this,this.animateId=c,c++,this.sprite=a,this.isSpriteAdd=!1,this.soundManager=d,this.bundles=[],this.curBundle=0,this.lastBundle=-1,this.spriteOrigin=null,this.startTime=-1,this.frameNumber=0,this.time=0}function g(a,b,c,d,e,f,g){var h=(a+c)/2,i=(b+d)/2,j=i-b,k=a-h,l=Math.sqrt(j*j+k*k),m=0;if(k===0)j>0?m=-Math.PI/2:m=Math.PI/2;else{var n=Math.atan(j/Math.abs(k));k>0?m=n:m=Math.PI-n}var o=0;g?o=1*f*e*Math.PI:o=-1*f*e*Math.PI;var p=m+o,q={};return q.x=Math.floor(h+l*Math.cos(p)),q.y=Math.floor(i+l*Math.sin(p)),q}"use strict";var b=[],c=0;d.prototype.set=function(a,b){if(this.timeLine.length===0)this.timeLine.push({time:a,object:b});else{var c=!1;for(var d in this.timeLine)if(a<=this.timeLine[d].time){this.timeLine.splice(d,0,{time:a,object:b}),c=!0;break}c===!1&&this.timeLine.push({time:a,object:b})}},d.prototype.start=function(){this.startTime<0&&(this.startTime=a.millitime(),this.step())},d.prototype.step=function(){while(this.timeLine.length>0&&this.timeLine[0].time<=this.time)typeof this.timeLine[0].object!="undefined"&&this.timeLine[0].object.start(),this.timeLine.shift();this.time=a.millitime()-this.startTime,a.setTimeout(0,function(a){return function(){a.step()}}(b[this.animateId]))},e.prototype.add=function(){for(var a=0;a<arguments.length;a++)this.list[this.index]=arguments[a],this.index++},e.prototype.start=function(){for(var a in this.list)var b=this.list[a].start()},e.prototype.clone=function(){var a=new e;for(var b in this.list)arguments.length>b?a.list[a.index]=this.list[b].clone(arguments[b]):a.list[a.index]=this.list[b].clone(),a.index++;return a.index=this.index,a.speed=this.speed,a.stop=this.stop,a},e.prototype.offset=function(a,b){for(var c in this.list)this.list[c].offset(a,b)},f.prototype.animate=function(){return arguments.length>0&&this.addBundle(arguments),this},f.prototype.addBundle=function(a){var b=[];for(var c=0;c<a.length;c++){var d=this.createEffect(a[c]);b.push(d)}this.bundles.push(b)},f.prototype.createEffect=function(a){var b=0,c=j.NONE;return typeof a.frames!="undefined"?(b=a.frames,c=j.FRAMES):typeof a.time!="undefined"&&(b=a.time,c=j.TIME),a.properties={complete:!1,duration:b,durationType:c,shift:typeof a.shift!="undefined"?a.shift:h.line,ease:typeof a.ease!="undefined"?a.ease:i.none},delete a.duration,delete a.frames,delete a.time,a},f.prototype.start=function(){this.startTime<0&&(this.isSpriteAdd===!1&&(a.add(this.sprite),this.isSpriteAdd=!0),this.startTime=a.millitime(),this.step())},f.prototype.step=function(){if(this.bundles.length===0)return;if(this.curBundle>=this.bundles.length)return;this.frameNumber++;var c=!1;while(c===!1)this.curBundle<this.bundles.length&&this.stepBundle()===!0||(c=!0);a.setTimeout(0,function(a){return function(){a.step()}}(b[this.animateId]))},f.prototype.stepBundle=function(){if(this.curBundle!==this.lastBundle){this.spriteOrigin!==null&&delete this.spriteOrigin,this.spriteOrigin=[];for(var b in this.sprite)this.sprite.hasOwnProperty(b)&&(this.spriteOrigin[b]=this.sprite[b]);this.startTime=a.millitime(),this.lastBundle=this.curBundle}var c=!0,d=this.bundles[this.curBundle];if(d.length>0)for(var e=0;e<d.length;e++){this.time=a.millitime()-this.startTime;var f=d[e];f.properties.complete===!1&&(this.stepEffect(f),c=!1),f.properties.next===!0&&(c=!0)}return c===!0&&this.curBundle++,c},f.prototype.getDelta=function(a){var b=1,c=!0;if(a.properties.durationType!==j.NONE&&a.properties.duration>0){var d=0;a.properties.durationType===j.FRAMES?d=this.frameNumber:a.properties.durationType===j.TIME&&(d=this.time),d>a.properties.duration?(b=1,c=!0):(b=a.properties.ease.calculate(d/a.properties.duration),c=!1)}return{percent:b,finish:c}},f.prototype.stepEffect=function(b){if(typeof b.animation!="undefined")b.animation.start(),b.properties.complete=!0;else if(typeof b.remove!="undefined")this.sprite.position(-1e3,-1e3),a.remove(this.sprite),this.isSpriteAdd=!0,b.properties.complete=!0;else if(typeof b.execute!="undefined")b.execute(),b.properties.complete=!0;else if(typeof b.sound!="undefined")this.soundManager.get(b.sound).play(),b.properties.complete=!0;else if(typeof b.clear!="undefined"){for(var c=0;c<this.curBundle;c++)this.bundles.shift();b.properties.complete=!0}else if(typeof b.repeat!="undefined"){if(b.repeat!==0)for(var d=0;d<this.bundles.length;d++)for(var e=0;e<this.bundles[d].length;e++)this.bundles[d][e].properties.complete=!1,this.bundles[d][e].properties.next=!1;b.repeat>0?(this.curBundle=-1,this.startTime=0,b.repeat--):b.repeat<0&&(this.curBundle=-1,this.startTime=0),b.properties.complete=b.repeat===0?!0:!1,b.properties.next=!0}else{var f=this.getDelta(b);for(var g in b)b.hasOwnProperty(g)&&g!=="properties"&&g!=="x"&&g!=="y"&&(this.sprite[g]=this.spriteOrigin[g]+f.percent*(b[g]-this.spriteOrigin[g]));var h=typeof b.x!="undefined"?b.x:this.spriteOrigin.x,i=typeof b.y!="undefined"?b.y:this.spriteOrigin.y;if(h!==this.spriteOrigin.x||i!==this.spriteOrigin.y){var j=b.properties.shift.calculate(this.spriteOrigin.x,this.spriteOrigin.y,h,i,f.percent);this.sprite.x=j.x,this.sprite.y=j.y}f.finish===!0&&(b.properties.complete=!0)}},f.prototype.move=function(a,b){var c=[];return c.push({x:a,y:b}),this.addBundle(c),this},f.prototype.setSlice=function(a,b,c,d){var e=[];return e.push({sliceX:a,sliceY:b,width:c,height:d,sliceWidth:c,sliceHeight:d}),this.addBundle(e),this},f.prototype.wait=function(a){var b=[];return b.push({frames:a}),this.addBundle(b),this},f.prototype.waitTime=function(a){var b=[];return b.push({time:a}),this.addBundle(b),this},f.prototype.remove=function(){var a=[];a.push({remove:!0}),this.addBundle(a)},f.prototype.repeat=function(a){var b=[];return b.push({repeat:typeof a!="undefined"?a:-1}),this.addBundle(b),this},f.prototype.startAnimation=function(a){var b=[];return b.push({animation:a}),this.addBundle(b),this},f.prototype.execute=function(a){var b=[];return b.push({execute:a}),this.addBundle(b),this},f.prototype.sound=function(a){var b=[];return b.push({sound:a}),this.addBundle(b),this},f.prototype.pauseSound=function(a){var b=[];return b.push({pauseSound:a}),this.addBundle(b),this},f.prototype.clear=function(){var a=[];return a.push({clear:!0}),this.addBundle(a),this},f.prototype.clean=function(){this.bundles=[],this.curBundle=0,this.lastBundle=-1,this.spriteOrigin=null,this.startTime=-1,this.time=0},f.prototype.offset=function(a,b){this.sprite.x+=a,this.sprite.y+=b;for(var c in this.bundles)for(var d in this.bundles[c])typeof this.bundles[c][d].x!="undefined"&&(this.bundles[c][d].x+=a),typeof this.bundles[c][d].y!="undefined"&&(this.bundles[c][d].y+=b)},f.prototype.clone=function(b){a.add(b);var c=new f(b);for(var d in this)this.hasOwnProperty(d)&&d!=="animateId"&&d!=="bundles"&&d!=="sprite"&&(c[d]=this[d]);for(var e in this.bundles){var g=[];for(var h in this.bundles[e]){var i={};for(var j in this.bundles[e][h])if(j==="properties"){var k={};for(var l in this.bundles[e][h][j])k[l]=this.bundles[e][h][j][l];i[j]=k}else i[j]=this.bundles[e][h][j];g.push(i)}c.bundles.push(g)}return c};var h={line:{calculate:function(a,b,c,d,e){var f={};return f.x=a+e*(c-a),f.y=b+e*(d-b),f}},circle:{calculate:function(a,b,c,d,e){return g(a,b,c,d,e,1,2)}},circleReverse:{calculate:function(a,b,c,d,e){return g(a,b,c,d,e,-1,2)}},semiCircle:{calculate:function(a,b,c,d,e){return g(a,b,c,d,e,1,1)}},semiCircleReverse:{calculate:function(a,b,c,d,e){return g(a,b,c,d,e,-1,1)}}},i={none:{calculate:function(a){return a}},parabolic:{calculate:function(a){return a*a}},parabolicReverse:{calculate:function(a){return 1-(a-1)*(a-1)}}},j={NONE:1,FRAMES:2,TIME:3};a.Clip=e,a.TimeLine=d,a.Animation=f,a.Ease=i,a.Shift=h}(WCP),function(a){function b(){this._assetsCollection=[],this._assetPath="",this._progressInterval=100}function c(a){var b=new Audio;for(var c=0;c<a.path.length;c++){var d=a.path[c].match(/\.[0-9a-z]+$/);if(d.length){d=d[0];var e=d===".mp3"?"audio/mp3":d===".ogg"?"audio/ogg":undefined;if(e){if(b.canPlayType(e)!==""){var f=new Audio;f.src=a.path[c],f.preload="auto",a.status=1,f.addEventListener("canplaythrough",function(a){return function(){a.status=2}}(a)),f.addEventListener("readystatechange",function(a){return function(){console.log("!! je sais pas quand survient cette evenement cette asset est chargÃ©",a.id),a.status=2}}(a)),f.addEventListener("error",function(a){return function(){a.status=3}}(a)),a.asset=f;break}}else console.error("Extension not compatible")}}}function d(a){var b=a.path.match(/\.[0-9a-z]+$/);if(b.length){b=b[0];if(b===".jpg"||b===".png"||b===".gif"){var c=new Image;c.src=a.path,a.status=1,c.addEventListener("load",function(a){return function(){a.status=2}}(a)),c.addEventListener("readystatechange",function(a){return function(){console.log("!! je sais pas quand survient cette evenement cette asset est chargÃ©",a.id),a.status=2}}(a)),c.addEventListener("error",function(a){return function(){a.status=3}}(a)),a.asset=c}else console.error("Extension not compatible",a)}}"use strict",b.prototype.add=function(){var a=this,b=arguments.length;if(b===1&&typeof arguments[0]=="object"){var c=arguments[0],d=c.group||null,e=c.path||"";for(var f in c.assets)if(Array.isArray(c.assets[f])){for(var g=0;g<c.assets[f].length;g++)c.assets[f][g]=e+c.assets[f][g];d?this.add(d,f,c.assets[f]):this.add(f,c.assets[f])}else d?this.add(d,f,e+c.assets[f]):this.add(f,e+c.assets[f])}else if(b===2)this.add(null,arguments[0],arguments[1]);else if(b===3){var h;Array.isArray(arguments[2])?(h=[],arguments[2].forEach(function(b){h.push(a._assetPath+b)})):h=a._assetPath+arguments[2],this._assetsCollection.push({id:arguments[1],group:arguments[0],status:0,path:h})}},b.prototype.load=function(a,b,e){var f=this;arguments.length===2&&(e=b,b=a,a="*");for(var g=0;g<this._assetsCollection.length;g++){var h=this._assetsCollection[g];if(h.group===a||a==="all"||a==="*")Array.isArray(h.path)?c(h):d(h)}var i=setInterval(function(){function c(a){var b=0,c=0,d=0;for(var e=0;e<f._assetsCollection.length;e++){var g=f._assetsCollection[e];if(g.group===a||a==="all"||a==="*")f._assetsCollection[e].status===2?b++:f._assetsCollection[e].status===3?d++:f._assetsCollection[e].status===1&&c++}return{loaded:b,loading:c,error:d,total:b+c+d}}var d=c(a);b&&b(a,d.total,d.loaded,d.error),d.loaded+d.error===f.size(a)&&(clearInterval(i),e(a,d.total,d.loaded,d.error))},f._progressInterval)},b.prototype.get=function(a){for(var b=0;b<this._assetsCollection.length;b++)if(this._assetsCollection[b].id===a)return this._assetsCollection[b].asset},b.prototype.path=function(a){return this._assetPath=a!==undefined?a:""},b.prototype.size=function(a){if(a!==undefined&&a!=="all"&&a!=="*"){var b=0;for(var c=0;c<this._assetsCollection.length;c++)this._assetsCollection[c].group===a&&b++;return b}return this._assetsCollection.length},a.Assets=new b}(WCP),function(a){function b(a,b){this.sound=a,this.sound.volume=.5,this.param(b)}function c(a,c){this.sounds=[],this.audio=a,this.params=c,this.sounds.push(new b(a,c)),this.clonable=!1,this.setLimit(10)}function d(){this.sounds=[],this.testFormats()}"use strict",b.prototype.param=function(a){var b;for(b in a)b==="volume"?this.sound[b]=a[b]/100:this.sound[b]=a[b]},b.prototype.play=function(){this.sound.play()},b.prototype.pause=function(){this.sound.pause()},b.prototype.paused=function(){return this.sound.paused||this.sound.currentTime===0||this.sound.currentTime===this.sound.duration},b.prototype.togglePlay=function(){this.sound.paused||this.sound.currentTime===0?this.sound.play():this.sound.pause()},b.prototype.mute=function(){this.sound.muted=!0},b.prototype.unmute=function(){this.sound.muted=!1},b.prototype.toggleMute=function(){this.sound.muted?this.unmute():this.mute()},b.prototype.muted=function(){return this.sound.muted},b.prototype.volume=function(a){return a&&(a>100&&(a=100),a<0&&(a=0),this.sound.volume=a/100),this.sound.volume*100},b.prototype.duration=function(a){return this.sound.duration},b.prototype.time=function(a){return a!=="undefined"&&a>=0&&(this.sound.currentTime=a),this.sound.currentTime},b.prototype.rearward=function(a){this.sound.currentTime-=a||1,this.sound.currentTime<=0&&(this.sound.currentTime=0,this.sound.play())},b.prototype.forward=function(a){this.sound.currentTime+=a||1},c.prototype.setLimit=function(a){this.limit=a,this.sounds.length=0;while(this.sounds.length<this.limit)this.clone()},c.prototype.getNew=function(){var a=new Audio(this.audio.src);return new b(a,this.params)},c.prototype.clone=function(){this.sounds.push(this.getNew())},c.prototype.play=function(){var a;for(a=0;a<this.sounds.length-1;a++)if(this.sounds[a].sound.currentTime==0||this.sounds[a].sound.currentTime==this.sounds[a].sound.duration){this.sounds[a].play();return}},c.prototype.pause=function(){},d.prototype.sound=function(a,c){var d=new b(a,c);return c&&c.id?this.sounds[c.id]=d:d.src&&(this.sounds[d.src]=d),d},d.prototype.channel=function(a,b){var d=new c(a,b);return b.id?this.sounds[b.id]=d:d.src&&(this.sounds[d.src]=d),d},d.prototype.availableFormats=function(){},d.prototype.get=function(a){var b;for(b in this.sounds)if(b===a)return this.sounds[b]},d.prototype.play=function(a){var c=new b(a,params);return c.play(),c},d.prototype.shutDown=function(){var a;for(a in this.sounds)this.sounds[a].pause()},d.prototype.testFormats=function(){var a=document.createElement("audio");typeof a.canPlayType=="function"&&(this.mp3=a.canPlayType("audio/mpeg")!=="",this.ogg=a.canPlayType('audio/ogg; codecs="vorbis"')!=="",this.mp4=a.canPlayType('audio/mp4; codecs="mp4a.40.5"')!=="")},a.SoundManager=d}(WCP),function(a,b,c){function e(a){var b=c.createElement("span");c.body.appendChild(b),b.setAttribute("id","spanBuffer"),d=c.getElementById("spanBuffer"),d.style.font=a.weight+" "+a.size+"px "+a.font;var e=c.createTextNode(a.text);b.appendChild(e);var f=d.offsetHeight,g=d.offsetWidth,h=0,i=0;return c.body.removeChild(d),{height:f,width:g,descent:h,ascent:i}}function f(b,c){a.ctx.save(),a.ctx.rotate(a.Tools.degresToRadian(c.rotation)),a.ctx.textBaseline=c.baseline,a.ctx.fillStyle=c.color,a.ctx.font=c.weight+" "+c.size+"px "+c.font,a.ctx.fillText(b,c.x,c.y),a.ctx.restore()}function g(b,c,d,f,g){return this.id=a.random(10,99999),typeof b=="object"?(this.txt=b.text||"",this.x=b.x||0,this.y=b.y||0,this.width=b.maxwidth||a.canvas.width,this.color=b.color||"#333333",this.rotation=b.rotation||0,this.baseline=b.baseline||"top",this.font=b.font||"sans-serif",this.size=b.size||12,this.weight=b.weight||"normal",this.wordwarp=b.wordwarp||!0):(this.txt=b||"",this.x=c||0,this.y=d||this.y,this.width=f||a.canvas.width,this.color=g||a.ctx.fillStyle,this.rotation=0,this.baseline="top",this.font="sans-serif",this.size=12,this.weight="normal",this.wordwarp=!0),this.metrics=e(this),this}"use strict";var d;g.prototype.draw=function(){if(this.txt!==""){var b=a.ctx.measureText(this.txt).width;if(b+this.x>this.width&&this.wordwarp){var c=this.txt.split(" "),d="";for(var e=0;e<c.length;e++){var g=d+c[e]+" ",h=a.ctx.measureText(g).width;h>this.width-this.x?(f(d,this),d=c[e]+" ",this.y+=this.metrics.height):d=g}f(d,this)}else f(this.txt,this)}},g.prototype.setFont=function(a,b,c){return arguments.lenght!==0&&(this.size=b||this.size,this.weight=c||this.weight,this.font=a),this.weight+" "+this.size+"px "+this.font},g.prototype.setSize=function(a){return arguments.lenght!==0&&(this.size=a,this.metrics=e(this)),this.size},g.prototype.setColor=function(b){return arguments.lenght!==0&&(this.color=b),a.ctx.fillStyle},g.prototype.setText=function(a){return arguments.lenght!==0&&(this.txt=a,this.metrics=e(this)),this.txt},g.prototype.setBaseline=function(a){return arguments.lenght!==0&&(this.baseline=a),this.baseline},a.Text=g}(WCP,window,document),function(a){function b(){}"use strict",b.blur=function(a,b){return this.applyFilter(a,"blur",b)},b.brightness=function(a,b){return this.applyFilter(a,"brightness",b)},b.colorAdjust=function(a,b){return this.applyFilter(a,"colorAdjust",b[0],b[1],b[2])},b.contrast=function(a,b){return this.applyFilter(a,"contrast",b)},b.grayscale=function(a){return this.applyFilter(a,"grayscale")},b.hue=function(a,b){return this.applyFilter(a,"hue",b)},b.invert=function(a){return this.applyFilter(a,"invert")},b.lightness=function(a,b){return this.applyFilter(a,"lightness",b)},b.mosaic=function(a,b){return this.applyFilter(a,"mosaic",b)},b.saturation=function(a,b){return this.applyFilter(a,"saturation",b)},b.sepia=function(a){return this.applyFilter(a,"sepia")},b.solarize=function(a){return this.applyFilter(a,"solarize")},b.threshold=function(a,b){return this.applyFilter(a,"threshold",b)},b.filter=function(a,b,c){return this.applyFilter(a,c[0],c[1],c[2],c[3])},b.applyFilter=function(b,c,d,e,f){if(!b)return a.log("filter: Unable to apply a filter on an inexisting object"),null;var g=a.bufferCanvas(b.width,b.height);b instanceof a.Sprite?g.ctx.drawImage(b.img,b.sliceX,b.sliceY,b.sliceWidth,b.sliceHeight,0,0,b.width,b.height):b instanceof Image&&g.ctx.drawImage(b,0,0,b.width,b.height);var h=this.filterApplyFilter(g.ctx,b,c,d,e,f);return g.ctx.putImageData(h,0,0),g},b.filterApplyFilter=function(a,b,c,d,e,f){var g={blur:this.filterApplyBlur,brightness:this.filterApplyBrightness,colorAdjust:this.filterApplyColorAdjust,contrast:this.filterApplyContrast,grayscale:this.filterApplyGrayscale,hue:this.filterApplyHueOrSaturation,invert:this.filterApplyInvert,lightness:this.filterApplyLightness,mosaic:this.filterApplyMosaic,saturation:this.filterApplyHueOrSaturation,sepia:this.filterApplySepia,solarize:this.filterApplySolarize,threshold:this.filterApplyThreshold},h=a.getImageData(0,0,b.width,b.height);return c==="hue"?e=0:c==="saturation"&&(e=d,d=0),c==="colorAdjust"&&typeof e=="undefined"&&typeof f=="undefined"&&(e=d[1],f=d[2],d=d[0]),g[c]&&g[c](h.data,h.width,h.height,d,e,f),h},b.filterApplyBlur=function(a,b,c,d){d=Math.max(1,d);var e=a;for(var f=0;f<d;f++){for(var g=0;g<b;g++)for(var h=0;h<c;h++){var i=(g+(h-1)*b)*4,j=a[i],k=a[i+1],l=a[i+2],m=(g-1+h*b)*4,n=a[m],o=a[m+1],p=a[m+2],q=(g+h*b)*4,r=a[q],s=a[q+1],t=a[q+2],u=(g+1+h*b)*4,v=a[u],w=a[u+1],x=a[u+2],y=(g+(h+1)*b)*4,z=a[y],A=a[y+1],B=a[y+2];h-1<0&&(j=a[q],k=a[q+1],l=a[q+2]),g-1<0&&(n=a[q],o=a[q+1],p=a[q+2]),g+1>=b&&(v=a[q],w=a[q+1],x=a[q+2]),h+1>=c&&(z=a[q],A=a[q+1],B=a[q+2]),e[q]=(j+n+r*2+v+z)/6,e[q+1]=(k+o+s*2+w+A)/6,e[q+2]=(l+p+t*2+x+B)/6}a=e}},b.filterApplyBrightness=function(a,b,c,d){d=Math.max(-150,Math.min(150,d))*100/150;for(var e=0;e<b;e++)for(var f=0;f<c;f++){var g=(e+f*b)*4,h=a[g],i=a[g+1],j=a[g+2];a[g]=Math.round(h*(1+d/100)),a[g+1]=Math.round(i*(1+d/100)),a[g+2]=Math.round(j*(1+d/100))}},b.filterApplyColorAdjust=function(a,b,c,d,e,f){d=Math.round(Math.max(0,Math.min(255,d))-255),e=Math.round(Math.max(0,Math.min(255,e))-255),f=Math.round(Math.max(0,Math.min(255,f))-255);for(var g=0;g<b;g++)for(var h=0;h<c;h++){var i=(g+h*b)*4,j=a[i]+d,k=a[i+1]+e,l=a[i+2]+f;j>255?a[i]=255:j<0?a[i]=0:a[i]=j,k>255?a[i+1]=255:k<0?a[i+1]=0:a[i+1]=k,l>255?a[i+2]=255:l<0?a[i+2]=0:a[i+2]=l}},b.filterApplyContrast=function(a,b,c,d){d=Math.max(-1,d);for(var e=0;e<b;e++)for(var f=0;f<c;f++){var g=(e+f*b)*4,h=a[g],i=a[g+1],j=a[g+2];a[g]=Math.round(h+d*(h-127)),a[g+1]=Math.round(i+d*(i-127)),a[g+2]=Math.round(j+d*(j-127))}},b.filterApplyGrayscale=function(a,b,c){for(var d=0;d<b;d++)for(var e=0;e<c;e++){var f=(d+e*b)*4,g=a[f],h=a[f+1],i=a[f+2],j=.3*g+.59*h+.11*i;a[f]=j,a[f+1]=j,a[f+2]=j}},b.filterApplyHueOrSaturation=function(a,b,c,d,e){d=Math.max(-180,Math.min(180,d)),d=d%360/360;var f=d*6;e=Math.max(-100,Math.min(100,e))/100,e<0?e++:e=e*2+1;for(var g=0;g<b;g++)for(var h=0;h<c;h++){var i=(g+h*b)*4,j=a[i],k=a[i+1],l=a[i+2],m=j;k>m&&(m=k),l>m&&(m=l);var n=j;k<n&&(n=k),l<n&&(n=l);var o=m-n,p=(n+m)/510;if(p>0&&o>0){var q=0,r=0,s=0;p<=.5?(q=o/(m+n)*e,q>1&&(q=1),r=p*(1+q)):(q=o/(510-m-n)*e,q>1&&(q=1),r=p+q-p*q),j===m?k===n?s=5+(m-l)/o+f:s=1-(m-k)/o+f:k===m?l===n?s=1+(m-j)/o+f:s=3-(m-l)/o+f:j===n?s=3+(m-k)/o+f:s=5-(m-j)/o+f,s<0&&(s+=6),s>=6&&(s-=6);var t=p+p-r,u=s>>0;u===0?(j=r*255,k=(t+(r-t)*(s-u))*255,l=t*255):u===1?(j=(r-(r-t)*(s-u))*255,k=r*255,l=t*255):u===2?(j=t*255,k=r*255,l=(t+(r-t)*(s-u))*255):u===3?(j=t*255,k=(r-(r-t)*(s-u))*255,l=r*255):u===4?(j=(t+(r-t)*(s-u))*255,k=t*255,l=r*255):u===5&&(j=r*255,k=t*255,l=(r-(r-t)*(s-u))*255)}j>255?a[i]=255:j<0?a[i]=0:a[i]=j,k>255?a[i+1]=255:k<0?a[i+1]=0:a[i+1]=k,l>255?a[i+2]=255:l<0?a[i+2]=0:a[i+2]=l}},b.filterApplyInvert=function(a,b,c){for(var d=0;d<b;d++)for(var e=0;e<c;e++){var f=(d+e*b)*4;a[f]=255-a[f],a[f+1]=255-a[f+1],a[f+2]=255-a[f+2]}},b.filterApplyLightness=function(a,b,c,d){d=Math.max(-100,Math.min(100,d))/100;for(var e=0;e<b;e++)for(var f=0;f<c;f++){var g=(e+f*b)*4,h=a[g],i=a[g+1],j=a[g+2];d<0?(h*=d+1,i*=d+1,j*=d+1):d>0&&(h=h*(1-d)+d*255,i=i*(1-d)+d*255,j=j*(1-d)+d*255),h>255?a[g]=255:h<0?a[g]=0:a[g]=h,i>255?a[g+1]=255:i<0?a[g+1]=0:a[g+1]=i,j>255?a[g+2]=255:j<0?a[g+2]=0:a[g+2]=j}},b.filterApplyMosaic=function(a,b,c,d){d=Math.max(2,d);for(var e=0;e<b;e+=d)for(var f=0;f<c;f+=d){var g=(e+f*b)*4,h=a[g],i=a[g+1],j=a[g+2],k=d,l=d;k+e>b&&(k=b-e),l+f>c&&(l=c-f);for(var m=e;m<e+k;m++)for(var n=f;n<f+l;n++){var o=(m+n*b)*4;a[o]=h,a[o+1]=i,a[o+2]=j}}},b.filterApplySepia=function(a,b,c){for(var d=0;d<b;d++)for(var e=0;e<c;e++){var f=(d+e*b)*4,g=a[f],h=a[f+1],i=a[f+2],j=g*.393+h*.769+i*.189,k=g*.349+h*.686+i*.168,l=g*.272+h*.534+i*.131;j>255?a[f]=255:j<0?a[f]=0:a[f]=j,k>255?a[f+1]=255:k<0?a[f+1]=0:a[f+1]=k,l>255?a[f+2]=255:l<0?a[f+2]=0:a[f+2]=l}},b.filterApplySolarize=function(a,b,c){for(var d=0;d<b;d++)for(var e=0;e<c;e++){var f=(d+e*b)*4,g=a[f],h=a[f+1],i=a[f+2];g>127&&(g=255-g),h>127&&(h=255-h),i>127&&(i=255-i),a[f]=g,a[f+1]=h,a[f+2]=i}},b.filterApplyThreshold=function(a,b,c,d){d=Math.max(0,Math.min(254,d));for(var e=0;e<b;e++)for(var f=0;f<c;f++){var g=(e+f*b)*4,h=a[g],i=a[g+1],j=a[g+2],k=0;.2126*h+.7152*i+.0722*j>=d&&(k=255),a[g]=k,a[g+1]=k,a[g+2]=k}},b.AQUA=[0,255,255],b.BLACK=[0,0,0],b.BLUE=[0,0,255],b.FUCHSIA=[255,0,255],b.GRAY=[128,128,128],b.GREEN=[0,128,0],b.LIME=[0,255,0],b.MAROON=[128,0,0],b.NAVY=[0,0,128],b.OLIVE=[128,128,0],b.PURPLE=[128,0,128],b.RED=[255,0,0],b.SILVER=[192,192,192],b.TEAL=[0,128,128],b.WHITE=[255,255,255],b.YELLOW=[255,255,0],a.Filter=b}(WCP),function(a){function b(b){if(b.length<2)return a.log("length too short"),null;for(var c=1;c<b.length;c++)if(b[0].length!==b[c].length)return a.log("Bad format"),null;this.matrix=b,this.line=b.length,this.column=b[0].length,this.line===this.column?this.square=this.line:this.square=null}function c(a){if(a.length<2)return null;var c=[];for(var d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a.length;e++)c[d][e]=d===e?a[d]:0}var f=new b(c);return f}function d(a){if(a<2)return null;var b=[];for(var d=0;d<a;d++)b[d]=1;var e=new c(b);return e}function e(a){var c=new b([[Math.cos(a),-Math.sin(a)],[Math.sin(a),Math.cos(a)]]);return c}function f(a){var c=new b([[1,0,0],[0,Math.cos(a),-Math.sin(a)],[0,Math.sin(a),Math.cos(a)]]);return c}function g(a){var c=new b([[Math.cos(a),0,Math.sin(a)],[0,1,0],[-Math.sin(a),0,Math.cos(a)]]);return c}function h(a){var c=new b([[Math.cos(a),-Math.sin(a),0],[Math.sin(a),Math.cos(a),0],[0,0,1]]);return c}function i(a,c){var d=[];for(var e=0;e<a;e++){d[e]=[];for(var f=0;f<c;f++)d[e][f]=0}var g=new b(d);return g}"use strict",b.prototype.add=function(a){if(this.column!==a.column||this.line!==a.line)return null;var b=this.cpy();for(var c=0;c<this.line;c++)for(var d=0;d<this.column;d++)b.matrix[c][d]=b.matrix[c][d]+a.matrix[c][d];return b},b.prototype.at=function(a,b){return this.matrix[a][b]},b.prototype.cpy=function(){var a=[];for(var c=0;c<this.line;c++){a[c]=[];for(var d=0;d<this.column;d++)a[c][d]=this.at(c,d)}var e=new b(a);return e},b.prototype.determinant=function(a){if(this.square===!1)return null;arguments.length===0&&(a=this.column);var b=0,c=new i(3,3);if(a===2)b=this.matrix[0][0]*this.matrix[1][1]-this.matrix[1][0]*this.matrix[0][1];else for(var d=0;d<a;d++){for(var e=1;e<a;e++){var f=0;for(var g=0;g<a;g++)g!==d&&(c.matrix[e-1][f]=this.matrix[e][g],f++)}b=b+Math.pow(-1,d)*this.matrix[0][d]*c.determinant(a-1)}return b},b.prototype.isSameSizeAs=function(a){return this.line===a.line&&this.column===a.column?!0:!1},b.prototype.mult=function(a){if(a instanceof b){var c=[];for(var d=0;d<this.line;d++){c[d]=[];for(var e=0;e<this.line;e++){var f=0;for(var g=0;g<this.column;g++)f+=this.at(d,g)*a.at(g,e);c[d][e]=f}}var h=new b(c);return h}},b.prototype.round=function(){var a=[];for(var c=0;c<this.line;c++){a[c]=[];for(var d=0;d<this.column;d++)a[c][d]=Math.round(this.at(c,d))}var e=new b(a);return e},b.prototype.show=function(b){arguments.length===1?a.log("/-- "+b+" ---"):a.log("/----------");for(var c=0;c<this.column;c++)console.log("["+this.matrix[c].toString()+"]");arguments.length===1?a.log("--- "+b+" --\\"):a.log("----------\\")},b.prototype.sub=function(a){if(this.column!==a.column||this.line!==a.line)return null;var b=this.cpy();for(var c=0;c<this.line;c++)for(var d=0;d<this.column;d++)b.matrix[c][d]=b.matrix[c][d]-a.matrix[c][d];return b},a.Matrix=b,a.MatrixDiagonal=c,a.MatrixIdentity=d,a.MatrixRotation=e,a.MatrixRotationX=f,a.MatrixRotationY=g,a.MatrixRotationZ=h,a.MatrixZero=i}(WCP);